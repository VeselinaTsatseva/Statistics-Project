pregnancies <-c("1","4+","0","4+","1","4+","[2,3]","[2,3]","4+","0","[2,3]","[2,3]","[2,3]","1","4+","4+","[2,3]","1","4+","[2,3]","4+","1","4+","4+","1","4+","0","0","4+","4+","4+","[2,3]","4+","[2,3]","0","0","4+","4+","0","[2,3]","4+","0","0","1","[2,3]","[2,3]","4+","4+","[2,3]","4+","4+","0","4+","4+","[2,3]","4+","1","1","0","4+","4+","0","0","0","4+","4+","4+","4+","[2,3]","[2,3]","1","1","1","[2,3]","[2,3]","1","1","[2,3]","[2,3]","4+","4+","4+","[2,3]","[2,3]","4+","4+","4+","0","0","[2,3]","4+","1","1","1","[2,3]","0","1","1","1","1","1","4+","1","1","4+","4+","4+","4+","4+","4+","1","1","0","1","4+","4+","0","1","4+","0","[2,3]","[2,3]","4+","[2,3]","[2,3]","[2,3]","4+","0","[2,3]","[2,3]","1","[2,3]","4+","[2,3]","4+","4+","4+","1","[2,3]","4+","4+","0","0","4+","0","1","4+","1","4+","0","1","1","[2,3]","[2,3]","[2,3]","4+","4+","4+","4+","1","1","[2,3]","[2,3]","[2,3]","4+","1","4+","0","0","[2,3]","[2,3]","4+","4+","4+","4+","4+","4+","[2,3]","1","4+","4+","4+","0","[2,3]","[2,3]","4+","4+","4+","0","1","[2,3]","[2,3]","[2,3]","4+","4+","4+","[2,3]","0","1","0","1","[2,3]","[2,3]","[2,3]","4+","4+","4+","4+","0","1","1","4+","4+","4+","4+","1","[2,3]","[2,3]","0","0","0","1","[2,3]","[2,3]","[2,3]","[2,3]","4+","4+","4+","0","0","1","[2,3]","4+","4+","4+","1","4+","1","[2,3]","1","[2,3]","1","1","[2,3]","[2,3]","[2,3]","[2,3]","4+","0","0","0","4+","0","0","[2,3]","[2,3]","0","[2,3]","[2,3]","4+","4+","1","4+","[2,3]","[2,3]","[2,3]","0","1","1","4+","1","1","1","[2,3]","[2,3]","4+","0","[2,3]","1","4+","1","1","[2,3]","[2,3]","[2,3]","1","4+","4+","0","1","[2,3]","1","0","[2,3]","[2,3]","4+","4+","1","[2,3]","[2,3]","4+","1","4+","0","[2,3]","[2,3]","[2,3]","[2,3]","1","0","[2,3]","[2,3]","4+","0","1","[2,3]","1","1","4+","1","1","1","1","[2,3]","1","1","[2,3]","4+","4+","[2,3]","[2,3]","[2,3]","4+","4+","4+","0","[2,3]","[2,3]","4+","0","1","[2,3]","[2,3]","4+","4+","4+","4+","1","[2,3]","4+","1","1","[2,3]","[2,3]","1","[2,3]","[2,3]","1","4+","1","0","1","1","1","1","0","0","1","1","4+","1","1","4+","4+","1","[2,3]","[2,3]","[2,3]","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","[2,3]","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+","4+")
age <- c(59,31,23,52,28,34,53,25,43,21,22,25,30,21,34,34,24,24,46,29,29,22,41,58,22,30,21,27,58,23,57,22,31,25,28,27,38,23,58,23,44,26,24,29,28,22,54,51,27,31,43,31,34,40,30,37,31,29,24,37,43,25,21,23,29,36,56,53,30,25,24,41,21,26,36,42,24,29,36,39,33,51,29,27,55,43,61,22,22,31,46,22,21,23,31,25,38,43,23,46,25,63,24,25,34,33,51,39,36,33,26,21,33,24,33,49,21,28,28,33,26,22,53,28,23,21,25,22,28,24,30,52,41,32,28,37,42,21,27,51,48,21,22,51,26,40,55,33,50,22,22,45,31,24,28,37,26,27,39,23,22,25,24,30,51,24,47,26,24,34,26,29,35,36,40,42,25,24,42,37,46,54,23,27,31,43,45,39,21,26,23,22,24,24,32,28,34,23,22,21,28,25,39,28,41,31,47,30,31,25,37,31,57,43,49,27,22,25,21,27,22,22,29,24,28,24,42,45,46,25,25,23,23,27,27,45,26,26,32,27,23,23,21,23,21,26,25,26,40,22,23,26,32,35,24,28,22,21,22,26,22,35,21,37,24,25,38,22,33,22,30,22,24,21,28,34,41,21,29,24,28,22,29,21,25,21,22,33,39,25,28,26,36,35,26,21,24,36,28,26,27,37,50,43,21,24,25,23,22,29,22,21,30,23,26,25,22,21,22,81,25,33,22,32,25,26,24,21,25,48,33,24,22,29,32,48,24,22,25,21,21,24,22,26,26,28,39,47,23,23,42,28,21,22,23,23,27,22,24,35,25,21,24,25,23,22,24,22,26,22,43,21,21,30,40,21,25,22,23,25,25,44,38,24,26,23,27,25,25,21,21,23,25,26,22,22,52,31,29,21,23,21,41,22,22,30,21,22,21,29,52,45,42,27,26,47,23,27,22,21,23,27,25,41,22,22,53,27,22,55,22,21,24,22,30,27,63,40,37,29,25,23,46,21,25,25,22,28,40,24,21,39,44,27,25,22,32,25,30,60,25,61,22,37,36,34,29,40,22,29,26,24,35,29,30,67,32,31,31,46,37,30,24,63,28,33,23,37,36,21,24,31,70,27,26,34,38,28,22,30,38,60,28,38,56,35,40,42,35,45,51,44,41,46,62,42,45,52,44,41,38,44,38)
BMI <- c(30.1,36.7,52.3,28.7,42.4,38.7,30.5,38.7,30.4,34.6,35.7,38.4,39.4,23.7,35.4,33.9,31.2,25.9,46.2,28,30.9,42.4,37.7,33.7,40,34.9,26.4,44.2,32,32.8,37.5,25.3,37,27.7,41.3,41.5,41.8,35.1,46.5,24.2,27.6,47.9,42.3,36.5,31.6,57.3,45.4,37.6,39.3,27.5,37.6,45.8,33.6,33.9,34.5,34.5,49.7,45.6,30.7,25.5,39.4,39.9,22.1,36.3,39.4,42.9,37.1,43.6,32.9,33.2,37.4,38.9,38.1,35.9,36.4,32,40.5,38.2,32.9,29.3,24,35.9,33.7,32.4,37.7,34,28.8,30.8,32,33.8,36.6,27.5,25.4,24,43.3,30.5,34.1,35,24.1,46.1,36.1,32.9,35.5,34.4,32,27.1,25.8,30.5,34.2,34.2,45.3,28.6,43.1,25.6,29.7,33.6,34.6,33.3,33.1,34.3,42.1,29,30.3,38.4,38,36.6,31.6,37.8,36.2,30.9,35.1,33.3,29.9,36.4,34.5,32.4,34.3,28.7,27.6,33.3,42.3,24.8,39.4,36.6,40.6,34.5,25.1,23.4,36.1,41.5,23.2,32.8,33.8,39.4,38.1,29.5,28.6,46.1,40.6,25.2,34.2,31.6,33.3,42.9,26,34.8,25.5,67.1,42.6,30.9,33.2,35.4,24,32.7,37.9,28.3,35.8,25.4,29.3,31.3,32,35.2,38.2,32.4,29.9,38.5,28.9,35.9,27.4,23.1,45.5,34.7,44.5,33.2,30,35.5,30.5,27.8,28.5,43.5,36.9,28.5,24.7,26.4,31.1,27.9,40.9,26.2,46.8,24.3,36.5,23.8,22.2,37.1,38.5,33.8,29.8,31.9,21.8,29.3,44.6,25.9,39.7,37.8,31.6,26.3,39.1,37.2,30,53.2,36.8,25.2,33.6,28.9,28.4,30.9,55,34.8,34.6,26.6,21.2,39.1,28.1,33.3,24.6,34.1,34.9,30.8,33.1,28.7,34.9,36.5,40.9,36.5,34.5,32.9,21.8,26.4,26.1,31,33.1,35,33.2,22.1,25.6,29.5,30.4,25.2,43.3,28.7,34,19.4,30.8,18.2,31.6,28.4,33.3,40.6,28.4,37.6,34.1,20.4,32,26,30.1,30.4,37.2,36.1,25.9,36.6,39,21.8,25.9,43.4,38.5,25.2,30.2,29.3,25.3,34,34.2,30.8,32.8,33.6,35.8,36.8,25,31.6,27.5,41.3,33.6,24.7,19.3,28.7,30.5,35.5,32.5,26.2,30,25.9,25.1,32,23.9,46.3,40.5,23.6,33.3,25.2,39.5,20.8,29.7,24.4,24.8,37.7,26.9,35.3,45.2,29,32.7,23.2,30.8,22.3,32.2,21.1,20.8,27.8,35.3,35.5,43.5,22.9,46.7,19.5,33.2,24.2,29.7,29.9,20.4,29.5,27.2,35.8,19.5,36.9,26.6,19.6,31.2,25.4,37.4,27.8,24.2,34.6,26.8,27.8,27.7,24.4,29.6,38.6,34.3,28.4,20.1,59.4,42,40.5,32.5,42.8,35.7,44.1,18.4,35.8,36.3,24.7,32.4,26.4,35.3,49.6,25,32.4,36.3,26.6,29.7,23,30.1,33.6,43.3,32,27.2,27.8,35.8,42.9,25.4,28.3,35,32.8,39.5,49.3,37.5,30.1,30.4,38.2,28,26,26.2,26.8,23.5,38.5,22.9,30.1,23.3,36.8,22.4,21.1,32.5,22.6,37.2,25.6,30.1,30,32.4,23,21,30.5,31.6,23.5,34.4,42.7,21.1,34.9,25,37.2,37.3,31.6,21.8,32.5,34.4,25.8,36,23.1,29.5,26,37.6,23.8,34,31.2,28.2,21.9,29.7,29.6,31.9,27.6,44,35,43.6,32.1,32,42.2,31.2,38.5,48.3,32.9,32,28.9,38.5,29.7,28.9,28,25.6,32.8,32.9,28.5,28.4,24.7,34.3,28,32.5,32.3,44.5,29.3,39.4,35.4,31.2,25.6,34.1,36,29.9,41.2,23.1,33.2,52.3,46.2,30.1,46.8,39,23.6,37.4,29.7,26.5,43.4,36.6,34.2,39.9,32.8,31.2,42.3,33.6)

diabet <- data.frame(pregnancies, age, BMI, glucose)
  
# -----------------------------------------------

# pregnancies 
dpt <- table(diabet$pregnancies)  # честотно разпределение
dptpercent <- round(prop.table(dt)*100, 2) # процентно разпределение

# графика на честотното разпределение
barplot(height = dpt, col = "skyblue1", main = "Pregnancy frequency distribution")

# графика на процентното разпределение
pie(dpt, labels = dptpercent,main = "Pregnancies percentage distribution", col = c("plum2", "palegreen1", "palevioletred1", "paleturquoise1"), radius = 1)
legend(x = "topleft", legend = c("[2,3]", "0", "1", "4+"), cex = 1, fill = c("plum2", "palegreen1", "palevioletred1", "paleturquoise1"))

# медиана
median(diabet$pregnancies)

# -----------------------------------------------

# age 
summary(diabet$age) 
IQR(diabet$age)
mad(diabet$age)

#графики
boxplot(diabet$age, col = "steelblue1", main = "Age Boxplot", horizontal = T)
hist(diabet$age, main = "Age frequency distribution", xlab = "Age", col = "steelblue1")

shapiro.test(diabet$age)  # тест за разпределението

#------------------------------------------------

# BMI   
summary(diabet$BMI)
sd(diabet$BMI)     
mad(diabet$BMI)    
IQR(diabet$BMI)     

#графики
boxplot(diabet$BMI, col = "palegreen1", main = "BMI Boxplot", horizontal = T)
hist(diabet$BMI, main = "BMI frequency distribution", xlab = "BMI", col = "palegreen1")

# QQ plot
nbmi <- rnorm(n = 523, mean = mean(diabet$BMI), sd = sd(diabet$BMI))
qqplot(diabet$BMI, nbmi, ylab = "theoretical distribution", main = "Check for normal distr", xlab = "BMI")
abline(a = 0, b = 1, col = "red")

shapiro.test(diabet$BMI) # тест за норм разпр

#------------------------------------------------

# Pregnancy VS Age

aggregate(age ~ pregnancies, data = diabet, FUN = function(x) {shapiro.test(x)$p.value})  # изследване на разпределението
kruskal.test(age ~ pregnancies, data = diabet)
boxplot(age ~ pregnancies)

#------------------------------------------------

# Pregnancy VS BMI

aggregate(BMI ~ pregnancies, data = diabet, FUN = function(x) {shapiro.test(x)$p.value})  # изследване на разпределението
kruskal.test(age ~ pregnancies, data = diabet)
boxplot(BMI ~ pregnancies)

#------------------------------------------------

# Age VS BMI
plot(diabet$age, diabet$BMI)
cor.test(diabet$age, diabet$BMI)

model <- lm(BMI ~ age)
